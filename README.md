# CS6350-Computer-Vision-TPA

## Repository Structure
This repository contains codes used for the TPA-2 course project:

- `cv_grp1_tpa2_submission.ipynb`
- `extract_predictions.ipynb`
- `SampleData/` – sample images for demonstration
- `CustomData/` – custom images taken for demonstration
- `ShallowResults*/` – results generated by classical stereo methods

It also contains the final report and presentation.
- ComputerVision_Grp1_TPA2_FinalReport
- ComputerVision_Grp1_TPA2_FinalPPT

---

## 1. Requirements

Install the following:

Python 3.10+
Jupyter Notebook or JupyterLab  
OpenCV (cv2)  
NumPy  
Matplotlib  

For deep learning methods, check requirements of the repo cloned from.

Install packages:

```bash
pip install opencv-python numpy matplotlib torch torchvision
```

---

## 2. Dataset Setup

### KITTI Stereo Dataset

Download from:  
https://www.cvlibs.net/datasets/kitti/

You need the left and right stereo image folders.

Update your paths in the notebooks:

```yaml
left_path: "/path/to/KITTI/data_scene_flow/training/image_2/"
right_path: "/path/to/KITTI/data_scene_flow/training/image_3/"
```

Replace the placeholders with your actual dataset path.

---

## 3. Running `cv_grp1_tpa2_submission.ipynb`

This notebook includes:

- Block Matching (BM)
- Semi-Global Block Matching (SGBM)
- Edge-overlayed matching
- Intensity-gradient matching (Canny/Sobel)
- Census Transform matching
- Error metric computation

### Steps

1. Open the notebook:

```bash
jupyter notebook cv_grp1_tpa2_submission.ipynb
```

2. Update the image or dataset paths:

For DemoData:

```yaml
left_img_path: "DemoData/input_img_chc.png"
right_img_path: "DemoData/input_img_chc.png"
```

For KITTI:

```yaml
left_img_path: "/your/KITTI/left/image.png"
right_img_path: "/your/KITTI/right/image.png"
```

3. Run all cells from top to bottom.

This notebook extracts and evaluates:

- BM disparity maps  
- SGBM disparity maps  
- Error metrics (MAE, RMSE, SD, RMSE, SAD, SSD, Bad3, Bad5)  
- Visual comparisons  

Outputs will be saved in the corresponding results folders.

---

## 4. Running `extract_predictions_dtd.ipynb`

This notebook is used to run the **Dusk Till Dawn (DTD)** pretrained model on:

- the **DTD dataset** (nighttime RobotCar sequences) -  https://github.com/madhubabuv/dtd
- the **KITTI stereo dataset** - https://www.cvlibs.net/datasets/kitti/index.php

It extracts predicted disparity maps and saves them for further comparison.

### Steps

1. Open the notebook:

```bash
jupyter notebook extract_predictions.ipynb
```

2. Set the paths for pretrained DTD weights and dataset folders:

```yaml
# for dtd dataset
number_file = "datasets/robotcar/files/2014-12-16-18-44-24_numbered.txt" # custom file present in this repo, put it in appropriate folder
image_dir = "datasets/robotcar/2014-12-16-18-44-24/stereo/left" # download dtd dataset for this

# for kitti dataset
image_id = "000157_10"    # change if needed
left_path = f"/path/to/KITTI/image_2/"
right_path = f"/path/to/KITTI/image_3/"
gt_path   = f"/path/to/KITTI/gt_path"
```

3. Select the mode to run:

```yaml
file_path = "dtd_predictions.npy"      # runs DTD on nighttime RobotCar images
file_path = "dtd_predictions_own.npy"  # runs DTD on KITTI stereo pairs    
```

4. Run all cells to generate:

- DTD disparity predictions  
- Visualization plots

  ## 5. Running `depth_map_shallow_coarsetofine.ipynb`

This notebook is used to run the coarse-to-fine shallow method on:

- the **KITTI stereo dataset** - https://www.cvlibs.net/datasets/kitti/index.php

### Steps

1. Open the notebook on Google colab:
2. Set the paths for the dataset folders and replace it appropriately in the notebook:
3. Refer to the following drive link for the data.
   https://drive.google.com/drive/folders/1xaxIvqAM-m6qd-a72DRGYP6g3bg16MPU?usp=sharing

   ## 6. Running 'Evaluation_KITTI_FNO.ipynb'

This notebook is used to evaluate the FNO deep learning method on:

- the **KITTI stereo dataset** - https://www.cvlibs.net/datasets/kitti/index.php

### Steps

1. Open the notebook on Google colab:
2. Set the paths for the dataset folders and replace it appropriately in the notebook:
3. Refer to the following drive link for the data.
   https://drive.google.com/drive/folders/1xaxIvqAM-m6qd-a72DRGYP6g3bg16MPU?usp=sharing

   The training files for this are in the lab system in the folder TPA2_Reva. The colab notebook uses the trained model.

   Github repo for reference: https://github.com/neuraloperator/neuraloperator/tree/main/doc
   Required dependency installation commands included in the notebook.

   ## 7. Running `Evaluation_KITTI_FastACVNet.ipynb`

   This notebook is used to evaluate the Fast-ACVNet deep learning method on:

- the **KITTI stereo dataset** - https://www.cvlibs.net/datasets/kitti/index.php

### Steps

1. Open the notebook on Google colab:
2. Set the paths for the dataset folders and replace it appropriately in the notebook:
3. Refer to the following drive link for the data.
   https://drive.google.com/drive/folders/1xaxIvqAM-m6qd-a72DRGYP6g3bg16MPU?usp=sharing

   The training files for this are in the lab system in the folder TPA2_Reva. The colab notebook uses the trained model.

   Github repo for reference: https://github.com/gangweix/Fast-ACVNet
   Required dependency installation commands included in the notebook.

## 8. Notes

- Always update all paths before running.
